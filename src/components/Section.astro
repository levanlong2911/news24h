---
import type { Post } from '../types';

const { posts = [] }: { posts: Post[] } = Astro.props;

const stripHtml = (html = '') =>
  html.replace(/<\/?[^>]+(>|$)/g, '');
---

<div class="grid-container">
    <section id="content">
        {posts.length > 0 ? (
            posts.map((post) => (
                <div class="grid-content" key={post.id}>
                    <div class="post-img">
                        <a href={`/post/${post.slug}`}>
                            <img src={post.thumbnail || 'https://docs.astro.build/assets/rose.webp'} alt={post.title} />
                        </a>
                    </div>
                    <div class="posts-title">
                        <a href={`/post/${post.slug}`}>
                            <h3 class="text-black font-bold">
                                {post.title}
                            </h3>
                        </a>
                        <span>
                            {post.admin?.name ?? 'Admin'}
                            {', '}
                            {post.updated_at
                                ? new Date(post.updated_at).toLocaleDateString()
                                : ''}
                            {post.category?.name ? `, ${post.category.name}` : ''}
                        </span>
                        <p class="description">
                            {stripHtml(post.content).slice(0, 150)}â€¦
                        </p>
                    </div>
                </div>
            ))
        ) : (
            <p>No posts available.</p>
        )}
    </section>
    <section id="silebar">
        <h3 class="list-post">POST NEW</h3>
        <ul>
            {posts.slice(0, 5).map((post) => (
                <li key={post.id}>
                    <div class="list-img">
                        <a href={`/post/${post.slug}`}>
                            <img src={post.thumbnail || 'https://docs.astro.build/assets/rose.webp'} alt={post.title} />
                            <h4 class="post-title">{post.title}</h4>
                        </a>
                    </div>
                </li>
            ))}
        </ul>
    </section>
</div>
